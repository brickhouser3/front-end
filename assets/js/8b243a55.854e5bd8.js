"use strict";(globalThis.webpackChunkfront_end=globalThis.webpackChunkfront_end||[]).push([[61],{7617(e,t,a){a.r(t),a.d(t,{default:()=>be});var i=a(6540),r=a(4894),s=a(7274),n=a(9872),l=a(4848);const o={"01":"AL","02":"AK","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY"},d={volume:"Vol",revenue:"Rev",share:"Share",adshare:"AdSh",pods:"PODs",taps:"TAPs",avd:"AVD",displays:"Disp"},c=(e,t)=>{if(0===e||isNaN(e))return"-";const a=Math.abs(e);return t.includes("share")||"adshare"===t?`${e.toFixed(1)}%`:"avd"===t?e.toFixed(1):"revenue"===t?a>=1e9?`$${(e/1e9).toFixed(1)}B`:a>=1e6?`$${(e/1e6).toFixed(1)}M`:a>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e.toFixed(0)}`:a>=1e9?`${(e/1e9).toFixed(1)}B`:a>=1e6?`${(e/1e6).toFixed(1)}M`:a>=1e3?`${(e/1e3).toFixed(0)}K`:e.toFixed(0)};function p(){const{filters:e,selectedPeriod:t,timeScope:a,includeAO:r}=(0,s.MZ)(),[n,l]=(0,i.useState)({}),[c,p]=(0,i.useState)({}),[u,h]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let i=!0;return(async()=>{h(!0);const s=Object.keys(d),n=await Promise.all(s.map(i=>(async i=>{const s=(n=t)&&0!==n.length?[...n].sort().reverse()[0]:"202512";var n;try{const t=await fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contract_version:"kpi_request.v1",kpi:i,groupBy:"state",max_month:s,scope:a,filters:{megabrand:e.megabrand,wholesaler_id:e.wslr_nbr,channel:e.channel,include_ao:r}})}),n=await t.json(),l={};return n.ok&&n.result.data_array.forEach(e=>l[e[0]]={val:parseFloat(e[1]),ly:parseFloat(e[2])}),l}catch{return{}}})(i)));if(i){const e={},t={};s.forEach(e=>t[e]={val:0,ly:0}),Object.values(o).forEach(a=>{e[a]={},s.forEach((i,r)=>{const s=n[r][a];s?(t[i].val+=s.val,t[i].ly+=s.ly,e[a][i]=s):e[a][i]={val:0,ly:0}})}),t.share&&(t.share.val/=50,t.share.ly/=50),t.adshare&&(t.adshare.val/=50,t.adshare.ly/=50),t.avd&&(t.avd.val/=50,t.avd.ly/=50),l(e),p(t),h(!1)}})(),()=>{i=!1}},[JSON.stringify(t),a,JSON.stringify(e),r]),{data:n,national:c,loading:u}}function u(e){return e>=.05?"#166534":e>=0?"#4ade80":e>=-.05?"#f87171":"#991b1b"}function h({onSelectState:e}){const[t,a]=(0,i.useState)(null),{data:r,national:s,loading:h}=p(),x=t?r[t]:s,g=t?`${t} Scorecard`:"National Total";return(0,l.jsx)("div",{style:{width:"100%",height:"160px",marginBottom:"1.5rem",padding:"0.5rem",fontFamily:"Inter, sans-serif",position:"relative",boxSizing:"border-box"},children:(0,l.jsxs)("div",{style:{display:"flex",height:"100%",gap:"1.5rem",alignItems:"flex-start"},children:[(0,l.jsx)("div",{style:{flex:"0 0 250px",height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(0,l.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,l.jsx)(n.ComposableMap,{projection:"geoAlbersUsa",style:{width:"100%",height:"100%"},children:(0,l.jsx)(n.Geographies,{geography:"https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json",children:({geographies:t})=>t.map(t=>{const i=o[t.id],s=r[i]?.volume,d=s&&s.ly>0?(s.val-s.ly)/s.ly:0;return(0,l.jsx)(n.Geography,{geography:t,onMouseEnter:()=>i&&a(i),onMouseLeave:()=>a(null),onClick:()=>i&&e?.(i),style:{default:{fill:u(d),outline:"none",stroke:"#fff",strokeWidth:.5},hover:{fill:"#1e40af",outline:"none",cursor:"pointer"},pressed:{fill:"#1e3a8a",outline:"none"}}},t.rsmKey)})})})})}),(0,l.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.4rem",background:"rgba(255,255,255,0.6)",borderRadius:12,padding:"8px 12px",border:"1px solid rgba(0,0,0,0.05)"},children:[(0,l.jsxs)("div",{style:{display:"flex",gap:"0.6rem",alignItems:"center",borderBottom:"1px solid rgba(0,0,0,0.06)",paddingBottom:4},children:[(0,l.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:800,color:"#1e293b",textTransform:"uppercase"},children:g}),(0,l.jsx)("div",{style:{fontSize:"0.6rem",color:"#64748b",marginLeft:"auto"},children:h?"Loading...":"vs Last Year"})]}),!h&&x&&(0,l.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px 16px"},children:Object.keys(d).map(e=>{const t=x[e]||{val:0,ly:0},a=t.ly>0?(t.val-t.ly)/t.ly*100:0;return(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("span",{style:{fontSize:"0.55rem",fontWeight:700,color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.05em"},children:d[e]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:6},children:[(0,l.jsx)("span",{style:{fontSize:"0.85rem",fontWeight:700,color:"#0f172a"},children:c(t.val,e)}),(0,l.jsxs)("span",{style:{fontSize:"0.6rem",fontWeight:600,color:a>=0?"#166534":"#991b1b"},children:[a>0?"+":"",a.toFixed(0),"%"]})]})]},e)})})]})]})})}var x=a(2864),g=a(6589),f=a(1387),y=a(5791),m=a(6069),v=a(8543),b=a(4202),j=a(6108),S=a(7677);function k(){const[e,t]=i.useState(new Set),a=i.useCallback(e=>{t(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),r=i.useCallback(t=>e.has(t),[e]);return{expanded:e,toggle:a,isOpen:r}}const A="0.4rem",F="0.6rem",w=e=>`220px repeat(${e}, minmax(0, 1fr))`,C={width:"100%",minWidth:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",lineHeight:1.15},T=[{key:"volume",label:"Volume",icon:x.A},{key:"revenue",label:"Net Rev",icon:g.A},{key:"share",label:"Share",icon:f.A},{key:"adshare",label:"Ad Share",icon:y.A},{key:"pods",label:"PODs",icon:m.A},{key:"taps",label:"TAPs",icon:v.A},{key:"avd",label:"AVD",icon:b.A},{key:"displays",label:"Displays",icon:j.A}],M={"01":"Region 1","02":"Region 2","03":"Region 3","04":"Region 4","05":"Region 5","06":"Region 6","07":"Region 7","08":"Region 8"},D=(e,t)=>{if(null==e||isNaN(e)||0===e)return"-";const a=Math.abs(e);return t.includes("share")||"adshare"===t?`${e.toFixed(1)}%`:"avd"===t?e.toFixed(1):"revenue"===t?a>=1e9?`$${(e/1e9).toFixed(1)}B`:a>=1e6?`$${(e/1e6).toFixed(1)}M`:a>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e.toFixed(0)}`:a>=1e9?`${(e/1e9).toFixed(1)}B`:a>=1e6?`${(e/1e6).toFixed(1)}M`:a>=1e3?`${(e/1e3).toFixed(0)}K`:e.toFixed(0)},O=({level:e,groupBy:t,parentFilters:a,pathPrefix:r,drill:n,selectedMetric:o,hoverCol:d,setHoverCol:c})=>{const{filters:p,selectedPeriod:u,timeScope:h,includeAO:x}=(0,s.MZ)(),[g,f]=(0,i.useState)([]),[y,m]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let i=!0;return(async()=>{m(!0);const r=await Promise.all(T.map(e=>(async e=>{const i=(r=u)&&0!==r.length?[...r].sort().reverse()[0]:"202512";var r;try{const r=await fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contract_version:"kpi_request.v1",kpi:e,groupBy:t,max_month:i,scope:h,filters:{...p,...a,include_ao:x}})}),s=await r.json(),n={};return s.ok&&s.result.data_array.forEach(e=>{n[e[0]]={cy:parseFloat(e[1]),ly:parseFloat(e[2])}}),n}catch(s){return{}}})(e.key)));if(!i)return;const s=new Set;r.forEach(e=>Object.keys(e).forEach(e=>s.add(e)));const n=Array.from(s).map(t=>{const a={};return T.forEach((e,i)=>{const s=r[i][t];if(!s)return void(a[e.key]={value:0,delta:0});const n=0===s.ly?0:(s.cy-s.ly)/s.ly*100;a[e.key]={value:s.cy,delta:n}}),{id:t,name:"region"===e&&M[t]||t,level:e,data:a}});f(n.sort((e,t)=>e.name.localeCompare(t.name))),m(!1)})(),()=>{i=!1}},[JSON.stringify(u),h,JSON.stringify(p),JSON.stringify(a),x]),y?(0,l.jsxs)("div",{style:{padding:"8px",paddingLeft:"40px",fontSize:"0.75rem",color:"#94a3b8"},children:["Loading ",e,"s..."]}):(0,l.jsx)(l.Fragment,{children:g.map(t=>{const s=r?`${r}|${e}:${t.id}`:`${e}:${t.id}`,p=n.isOpen(s),u="region"===e?0:"state"===e?20:40;return(0,l.jsxs)(i.Fragment,{children:[(0,l.jsxs)("div",{onClick:()=>"wholesaler"!==e&&n.toggle(s),style:{display:"grid",gridTemplateColumns:w(T.length),gap:A,padding:`${F} 0.5rem`,borderBottom:"1px solid #f1f5f9",cursor:"wholesaler"!==e?"pointer":"default",background:p?"#f8fafc":"white"},children:[(0,l.jsxs)("div",{style:{paddingLeft:u,fontWeight:600,fontSize:"0.85rem",display:"flex",alignItems:"center",gap:6,color:"#334155"},children:["wholesaler"!==e&&(0,l.jsx)(S.A,{size:14,style:{transform:p?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"}}),"wholesaler"===e&&(0,l.jsx)("div",{style:{width:14}}),t.name]}),T.map((e,a)=>{const i=t.data[e.key],r=o&&o!==e.key;return(0,l.jsxs)("div",{style:{...C,opacity:r?.35:1,background:d===a?"rgba(59,130,246,0.04)":"transparent"},onMouseEnter:()=>c(a),onMouseLeave:()=>c(null),children:[(0,l.jsx)("div",{style:{fontWeight:600,fontSize:".85rem"},children:D(i.value,e.key)}),(0,l.jsxs)("div",{style:{fontSize:"0.65rem",fontWeight:600,color:i.delta>0?"#166534":i.delta<0?"#b91c1c":"#6b7280"},children:[i.delta>0?"+":"",i.delta.toFixed(1),"%"]})]},e.key)})]}),p&&"region"===e&&(0,l.jsx)(O,{level:"state",groupBy:"state",parentFilters:{region:[t.id]},pathPrefix:s,drill:n,selectedMetric:o,hoverCol:d,setHoverCol:c}),p&&"state"===e&&(0,l.jsx)(O,{level:"wholesaler",groupBy:"wholesaler",parentFilters:{...a,state:[t.id]},pathPrefix:s,drill:n,selectedMetric:o,hoverCol:d,setHoverCol:c})]},t.id)})})};function $({selectedMetric:e}){const t=k(),[a,r]=(0,i.useState)(null);return(0,l.jsxs)("div",{style:{padding:"0.25rem",fontFamily:"Inter, sans-serif",height:"100%",overflowY:"auto",overflowX:"clip"},children:[(0,l.jsx)("div",{style:{position:"sticky",top:0,zIndex:10,background:"white",borderBottom:"2px solid #e2e8f0"},children:(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:w(T.length),gap:A,padding:`${F} 0.5rem`},children:[(0,l.jsx)("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#64748b",textTransform:"uppercase"},children:"Hierarchy"}),T.map((e,t)=>(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",background:a===t?"rgba(59,130,246,0.06)":"transparent"},onMouseEnter:()=>r(t),onMouseLeave:()=>r(null),children:(0,l.jsxs)("div",{style:C,children:[(0,l.jsx)(e.icon,{size:13,className:"text-slate-500"}),(0,l.jsx)("span",{style:{fontSize:"0.65rem",fontWeight:700,color:"#64748b",marginTop:"2px"},children:e.label})]})},e.key))]})}),(0,l.jsx)(O,{level:"region",groupBy:"region",parentFilters:{},pathPrefix:"",drill:t,selectedMetric:e,hoverCol:a,setHoverCol:r})]})}var B=a(6025),z=a(99);const L=["volume","revenue","pods","taps","displays"],N=(e,t)=>{if(null==e||isNaN(e)||0===e)return"-";const a=Math.abs(e);return t.includes("share")||"adshare"===t?`${e.toFixed(1)}%`:"avd"===t?e.toFixed(1):"revenue"===t?a>=1e9?`$${(e/1e9).toFixed(1)}B`:a>=1e6?`$${(e/1e6).toFixed(1)}M`:a>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e.toFixed(0)}`:a>=1e9?`${(e/1e9).toFixed(1)}B`:a>=1e6?`${(e/1e6).toFixed(1)}M`:a>=1e3?`${(e/1e3).toFixed(0)}K`:e.toFixed(0)},E=e=>e&&0!==e.length?[...e].sort().reverse()[0]:"202512",P={BDL:"BDL.jpg",BHL:"BHL.jpg",MUL:"MUL.jpg",BUD:"BUD.jpg",STA:"STA.jpg",NUTRL:"NUTRL.png",KGA:"KGA.png",CWFM:"CWFM.jpg",AO:"AO_logo_placeholder.png"},W=[{key:"volume",label:"Volume",icon:x.A},{key:"revenue",label:"Net Rev",icon:g.A},{key:"share",label:"Share",icon:f.A},{key:"adshare",label:"Ad Share",icon:y.A},{key:"pods",label:"PODs",icon:m.A},{key:"taps",label:"TAPs",icon:v.A},{key:"avd",label:"AVD",icon:b.A},{key:"displays",label:"Displays",icon:j.A}],_=({kpi:e,groupBy:t,parentFilters:a,activeBrandCols:r,gridLayout:n})=>{const{filters:o,selectedPeriod:d,timeScope:c,includeAO:p}=(0,s.MZ)(),[u,h]=(0,i.useState)([]),[x,g]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let i=!0;const s=async i=>{const r=E(d),s={contract_version:"kpi_request.v1",kpi:e,groupBy:t,max_month:r,scope:c,filters:{...o,...a,include_ao:p}};i&&(s.filters.megabrand=[i]);try{const e=await fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json(),a={};return t.ok&&t.result.data_array.forEach(e=>a[e[0]]=parseFloat(e[1])),a}catch{return{}}};return(async()=>{g(!0);const t=await Promise.all(r.map(e=>s(e))),a=await s();if(!i)return;const n=new Set(Object.keys(a));r.forEach((e,a)=>Object.keys(t[a]).forEach(e=>n.add(e)));const l=L.includes(e),o=Array.from(n).map(e=>{let i=0;const s=r.map((a,r)=>{const s=t[r][e]||0;return i+=s,s}),n=l?i:a[e]||0;return s.push(n),{name:e,data:s}});h(o.sort((e,t)=>t.data[t.data.length-1]-e.data[e.data.length-1])),g(!1)})(),()=>{i=!1}},[e,t,JSON.stringify(d),c,JSON.stringify(o),p,r]),x?(0,l.jsx)("div",{style:{padding:"8px 0 8px 40px",fontSize:"0.7rem",color:"#94a3b8"},children:"Loading details..."}):(0,l.jsx)("div",{style:{background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:u.map((t,a)=>(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:n,gap:4,padding:"6px 0",borderTop:0===a?"none":"1px dashed #e2e8f0"},children:[(0,l.jsx)("div",{style:{paddingLeft:40,fontSize:"0.75rem",color:"#64748b",fontWeight:500},children:t.name}),t.data.map((t,a)=>(0,l.jsx)("div",{style:{textAlign:"center",fontSize:"0.75rem",color:"#64748b"},children:N(t,e)},a))]},a))})};function I({selectedMetric:e}){const{filters:t,selectedPeriod:a,timeScope:r,includeAO:n}=(0,s.MZ)(),o=k(),d=(0,B.Ay)("/"),[c,p]=(0,i.useState)("region"),[u,h]=(0,i.useState)({}),[x,g]=(0,i.useState)(!0),f=(0,i.useMemo)(()=>{const e=["BDL","BHL","MUL","BUD","STA","NUTRL","KGA","CWFM"];return n&&e.push("AO"),e},[n]),y=(0,i.useMemo)(()=>`115px repeat(${f.length}, minmax(60px, 1fr)) 75px`,[f]);return(0,i.useEffect)(()=>{let e=!0;return(async()=>{g(!0);const i=E(a),s={};await Promise.all(W.map(async e=>{s[e.key]=await(async e=>{const a={...t,include_ao:n},s={contract_version:"kpi_request.v1",kpi:e,groupBy:"megabrand",max_month:i,scope:r,filters:a},l={contract_version:"kpi_request.v1",kpi:e,groupBy:"total",max_month:i,scope:r,filters:a};try{const[t,a]=await Promise.all([fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})]),i=await t.json(),r=await a.json(),n={};i.ok&&i.result.data_array.forEach(e=>n[e[0]]=parseFloat(e[1]));const o=f.map(e=>n[e]||0);let d=0;return d=L.includes(e)?o.reduce((e,t)=>e+t,0):r.ok&&r.result.data_array.length>0?parseFloat(r.result.data_array[0][1]):0,o.push(d),o}catch{return[]}})(e.key)})),e&&(h(s),g(!1))})(),()=>{e=!1}},[JSON.stringify(a),r,JSON.stringify(t),n,f]),(0,l.jsxs)("div",{style:{padding:"0.5rem",height:"100%",display:"flex",flexDirection:"column",fontFamily:"Inter, sans-serif",overflowX:"auto"},children:[(0,l.jsxs)("div",{style:{display:"flex",gap:12,padding:"8px",background:"#f8fafc",borderBottom:"1px solid #e2e8f0",alignItems:"center",minWidth:"fit-content"},children:[(0,l.jsxs)("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#64748b",textTransform:"uppercase",display:"flex",alignItems:"center",gap:4},children:[(0,l.jsx)(z.A,{size:14})," Drill Dimension:"]}),(0,l.jsxs)("select",{value:c,onChange:e=>p(e.target.value),style:{fontSize:"0.75rem",padding:"4px",borderRadius:4,border:"1px solid #cbd5e1"},children:[(0,l.jsx)("option",{value:"region",children:"Region"}),(0,l.jsx)("option",{value:"state",children:"State"}),(0,l.jsx)("option",{value:"channel",children:"Channel"}),(0,l.jsx)("option",{value:"wholesaler",children:"Wholesaler"})]})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:y,gap:4,padding:"8px 0",borderBottom:"2px solid #e2e8f0",alignItems:"end",background:"white",position:"sticky",top:0,zIndex:10,minWidth:"fit-content"},children:[(0,l.jsx)("div",{style:{fontWeight:700,fontSize:"0.7rem",color:"#94a3b8",paddingLeft:8},children:"METRIC / DRILL"}),f.map(e=>(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:P[e]?(0,l.jsx)("img",{src:`${d}img/brand_logos/${P[e]}`,style:{height:28,objectFit:"contain"},alt:e}):(0,l.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:700,color:"#475569"},children:e})},e)),(0,l.jsx)("div",{style:{fontWeight:800,textAlign:"center",fontSize:"0.75rem",color:"#1e293b"},children:"TOTAL"})]}),(0,l.jsx)("div",{style:{flex:1,overflowY:"auto",minWidth:"fit-content"},children:!x&&W.map(e=>{const t=u[e.key]||[],a=o.isOpen(e.key);return(0,l.jsxs)(i.Fragment,{children:[(0,l.jsxs)("div",{onClick:()=>o.toggle(e.key),style:{display:"grid",gridTemplateColumns:y,gap:4,padding:"10px 0",borderBottom:"1px solid #f1f5f9",cursor:"pointer",background:a?"#f1f5f9":"white"},children:[(0,l.jsxs)("div",{style:{paddingLeft:8,fontWeight:700,fontSize:"0.8rem",color:"#334155",display:"flex",alignItems:"center",gap:8},children:[(0,l.jsx)(S.A,{size:14,style:{transform:a?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"}}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,l.jsx)(e.icon,{size:14,className:"text-slate-400"}),e.label]})]}),t.map((a,i)=>(0,l.jsx)("div",{style:{textAlign:"center",fontSize:i===t.length-1?"0.85rem":"0.8rem",fontWeight:i===t.length-1?800:600,color:i===t.length-1?"#0f172a":"#475569"},children:N(a,e.key)},i))]}),a&&(0,l.jsx)(_,{kpi:e.key,groupBy:c,parentFilters:{},activeBrandCols:f,gridLayout:y})]},e.key)})})]})}var R=a(2586),Y=a(6844),K=a(7792),H=a(6316),J=a(1429);const V={volume:(0,l.jsx)(x.A,{size:18}),revenue:(0,l.jsx)(g.A,{size:18}),share:(0,l.jsx)(R.A,{size:18}),pods:(0,l.jsx)(m.A,{size:18}),taps:(0,l.jsx)(Y.A,{size:18}),displays:(0,l.jsx)(y.A,{size:18}),avd:(0,l.jsx)(Y.A,{size:18}),adshare:(0,l.jsx)(R.A,{size:18})},U=(0,l.jsx)(x.A,{size:18});function q({label:e,labelColor:t,value:a,vsYTD:i=0,vsLastMonth:r=0,vsTarget:s,icon:n,iconBg:o,active:d=!1,includeAO:c=!1,onIconClick:p}){const u=V[n]??U;return(0,l.jsxs)("div",{onClick:p,style:{minWidth:0,background:"#ffffff",borderRadius:"16px",padding:"1rem",display:"flex",flexDirection:"column",gap:"0.6rem",cursor:p?"pointer":"default",boxShadow:d?`0 0 0 2px ${o??"#CBD5E1"}, 0 12px 26px rgba(10,22,51,0.14)`:"0 8px 20px rgba(10,22,51,0.08)",transform:d?"translateY(-1px)":"translateY(0)",transition:"transform 140ms ease, box-shadow 140ms ease",position:"relative",overflow:"hidden"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",minWidth:0,alignItems:"flex-start"},children:[(0,l.jsxs)("div",{style:{minWidth:0,fontSize:"0.85rem",fontWeight:800,letterSpacing:"0.08em",color:t??"#0A1633",textTransform:"uppercase",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:8,display:"flex",alignItems:"center",gap:"6px"},children:[e,c&&(0,l.jsx)("span",{style:{display:"inline-block",padding:"2px 5px",borderRadius:"4px",background:"#DBEAFE",color:"#1E40AF",fontSize:"0.55rem",fontWeight:800,letterSpacing:"0.05em",lineHeight:1},children:"+AO"})]}),(0,l.jsx)("div",{style:{width:34,height:34,borderRadius:"50%",background:o??"#E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",color:"#0A1633",flex:"0 0 34px"},children:u})]}),(0,l.jsx)("div",{style:{minWidth:0,fontSize:"1.65rem",fontWeight:700,color:"#0A1633",lineHeight:1.1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:a,children:a}),void 0!==s&&(0,l.jsx)(G,{value:s}),(0,l.jsxs)("div",{style:{minWidth:0,display:"flex",justifyContent:"space-between",gap:10,fontSize:"0.75rem"},children:[(0,l.jsx)(Z,{label:"YTD",value:i}),(0,l.jsx)(Z,{label:"MoM",value:r})]})]})}function G({value:e}){const t=("string"==typeof e?parseFloat(e):e)>=0;return(0,l.jsxs)("div",{style:{minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"0.7rem",fontWeight:600,color:t?"#166534":"#b91c1c",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,l.jsx)(K.A,{size:13}),(0,l.jsxs)("span",{style:{minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:["vs Target: ",t?"+":"",e,"%"]})]})}function Z({label:e,value:t}){const a=("string"==typeof t?parseFloat(t):t)>=0;return(0,l.jsxs)("div",{style:{minWidth:0,display:"flex",gap:"4px",alignItems:"center",color:a?"#166534":"#b91c1c",fontWeight:600,whiteSpace:"nowrap"},children:[a?(0,l.jsx)(H.A,{size:12}):(0,l.jsx)(J.A,{size:12}),e,": ",a?"+":"",t,"%"]})}var X=a(5084),Q=a(4119),ee=a(9107),te=a(7984),ae=a(3495),ie=a(8880),re=a(59);const se=e=>e>=1e9?`${(e/1e9).toFixed(1)}B`:e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(0)}K`:e.toLocaleString(),ne=({active:e,payload:t,label:a})=>{if(e&&t&&t.length){const e=t[0].value,i=t[1]?.value;return(0,l.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #e2e8f0",padding:"8px 12px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[(0,l.jsx)("p",{style:{margin:0,fontSize:"0.75rem",fontWeight:700,color:"#64748b",marginBottom:4},children:a}),(0,l.jsxs)("div",{style:{display:"flex",gap:12,fontSize:"0.8rem",fontWeight:600},children:[(0,l.jsxs)("div",{style:{color:"#3b82f6"},children:["CY: ",se(e)]}),void 0!==i&&(0,l.jsxs)("div",{style:{color:"#94a3b8"},children:["LY: ",se(i)]})]})]})}return null};function le({data:e,title:t}){return(0,l.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[t&&(0,l.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:700,color:"#1e293b",marginBottom:"1rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:t}),(0,l.jsx)("div",{style:{flex:1,minHeight:0},children:(0,l.jsx)(X.u,{width:"100%",height:"100%",children:(0,l.jsxs)(Q.E,{data:e,margin:{top:5,right:5,left:-20,bottom:0},barGap:2,children:[(0,l.jsx)(ee.d,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),(0,l.jsx)(te.W,{dataKey:"period",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},dy:10}),(0,l.jsx)(ae.h,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:se}),(0,l.jsx)(ie.m,{content:(0,l.jsx)(ne,{}),cursor:{fill:"rgba(0,0,0,0.03)"}}),(0,l.jsx)(re.yP,{dataKey:"value_ly",name:"Last Year",fill:"#cbd5e1",radius:[4,4,0,0],barSize:12}),(0,l.jsx)(re.yP,{dataKey:"value",name:"Current Year",fill:"#3b82f6",radius:[4,4,0,0],barSize:12})]})})})]})}var oe=a(6110);function de(e,t,a){const{timeScope:r,includeAO:n}=(0,s.MZ)(),[l,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),[p,u]=(0,i.useState)(null);(0,i.useEffect)(()=>{let i=!0;return async function(){c(!0),u(null);const r=Array.isArray(a)&&a.length>0?[...a].sort().reverse()[0]:"202512";try{const a=await fetch("https://ci-capabilities-api.vercel.app/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contract_version:"kpi_request.v1",kpi:e,filters:{megabrand:t.megabrand,region:t.sls_regn_cd,state:t.mktng_st_cd,wholesaler_id:t.wslr_nbr,channel:t.channel,include_ao:n},groupBy:"time",max_month:r,scope:"YTD"})}),s=await a.json();if(i){if(!s.ok)throw new Error(s.error||"API Error");o(s)}}catch(s){i&&u(s.message)}finally{i&&c(!1)}}(),()=>{i=!1}},[e,JSON.stringify(t),JSON.stringify(a),n]);const h=(0,i.useMemo)(()=>{if(!l?.result?.data_array||0===l.result.data_array.length)return null;const t=l.result.data_array,i=Array.isArray(a)&&a.length>0?[...a].sort().reverse()[0]:"202512",s=t.findIndex(e=>e[0]===i),n=-1===s?t.length-1:s,o=t[n];if(!o)return null;const d=parseFloat(o[1]),c=parseFloat(o[2]),p=0===c?0:(d-c)/c*100;let u=0,h=0;for(let e=0;e<=n;e++)u+=parseFloat(t[e][1]),h+=parseFloat(t[e][2]);const x=0===h?0:(u-h)/h*100,g=!["share","adshare","avd"].includes(e);let f=d;"YTD"===r&&(f=g?u:d);return{currentValue:f,mtdPct:p,ytdPct:x,ytdValue:u,trendData:t.map(e=>({period:e[0],value:parseFloat(e[1]),value_ly:parseFloat(e[2])})),activePeriod:o[0]}},[l,a,r,e]);return{data:l,stats:h,loading:d,error:p}}const ce={volume:"#DCE7FF",revenue:"#D6F4F1",share:"#DDF5E6",pods:"#FFE8CC",taps:"#FFE1E1",displays:"#EFE3FF",avd:"#E9EEF5",adshare:"#F6E1FA"},pe=[{label:"Volume",text:"Down vs LY driven by Midwest softness.",icon:J.A,tone:"amber"},{label:"Share",text:"BIR share expanding in Grocery.",icon:H.A,tone:"gold"},{label:"Execution",text:"Displays outperforming plan.",icon:oe.A,tone:"navy"}],ue=e=>void 0===e||isNaN(e)?0:e.toFixed(1),he=e=>e>=1e9?`$${(e/1e9).toFixed(2)}B`:e>=1e6?`$${(e/1e6).toFixed(1)}M`:`$${e.toLocaleString()}`,xe=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(0)}K`:e.toLocaleString(),ge=e=>xe(e),fe=e=>`${e.toFixed(1)}%`,ye=e=>e.toFixed(1);function me(){const[e,t]=(0,i.useState)(null),{filters:a,selectedPeriod:r,includeAO:n}=(0,s.MZ)(),{stats:o,loading:d}=de("volume",a,r),{stats:c,loading:p}=de("revenue",a,r),{stats:u,loading:x}=de("share",a,r),{stats:g,loading:f}=de("pods",a,r),{stats:y,loading:m}=de("taps",a,r),{stats:v,loading:b}=de("displays",a,r),{stats:j,loading:S}=de("avd",a,r),{stats:k,loading:A}=de("adshare",a,r),F=(0,i.useMemo)(()=>{switch(e){case"volume":return o?.trendData;case"revenue":return c?.trendData;case"share":return u?.trendData;case"pods":return g?.trendData;case"taps":return y?.trendData;case"displays":return v?.trendData;case"avd":return j?.trendData;case"adshare":return k?.trendData;default:return null}},[e,o,c,u,g,y,v,j,k]),w=(e,t,a)=>e?"...":t?a(t.currentValue):"\u2014";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("style",{children:"\n        .exec-scope { color: #0A1633; }\n        .exec-update-shell { border-radius: 16px; padding: 1rem; border: 1px solid rgba(10,22,51,0.1); background: linear-gradient(180deg, rgba(247,249,252,0.92), rgba(247,249,252,0.78)); box-shadow: 0 12px 26px rgba(10,22,51,0.08), inset 0 1px 0 rgba(255,255,255,0.55); }\n        .exec-update-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 0.85rem; }\n        .exec-update-card { position: relative; display: flex; gap: 0.75rem; padding: 0.85rem; border-radius: 14px; background: rgba(255,255,255,0.65); border: 1px solid rgba(10,22,51,0.1); box-shadow: 0 10px 22px rgba(10,22,51,0.06), inset 0 1px 0 rgba(255,255,255,0.55); }\n        .exec-update-rail { position:absolute; left:0; top:10px; bottom:10px; width:3px; border-radius:999px; }\n        .tone-navy .exec-update-rail{ background: rgba(10,22,51,0.55); }\n        .tone-amber .exec-update-rail{ background: rgba(245,158,11,0.70); }\n        .tone-gold .exec-update-rail{ background: rgba(242,214,117,0.80); }\n        .subtle-scroll::-webkit-scrollbar { width: 4px; height: 4px; }\n        .subtle-scroll::-webkit-scrollbar-track { background: transparent; }\n        .subtle-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }\n      "}),(0,l.jsx)("div",{className:"exec-scope",children:(0,l.jsxs)("div",{style:{width:"100%",padding:"0.9rem 1rem",minWidth:0},children:[(0,l.jsx)("div",{style:{marginBottom:"1.15rem"},children:(0,l.jsx)("div",{className:"exec-update-shell",children:(0,l.jsx)("div",{className:"exec-update-grid",children:pe.map(e=>{const t=e.icon;return(0,l.jsxs)("div",{className:`exec-update-card tone-${e.tone}`,children:[(0,l.jsx)("div",{className:"exec-update-rail"}),(0,l.jsx)(t,{size:18}),(0,l.jsxs)("div",{style:{minWidth:0},children:[(0,l.jsx)("div",{style:{fontWeight:800},children:e.label}),(0,l.jsx)("div",{style:{fontSize:"0.78rem",opacity:.78},children:e.text})]})]},e.label)})})})}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1.05rem",marginBottom:"1.15rem"},children:[(0,l.jsx)(q,{label:"VOLUME",icon:"volume",iconBg:ce.volume,active:"volume"===e,onIconClick:()=>t(e=>"volume"===e?null:"volume"),value:w(d,o,ge),vsLastMonth:ue(o?.mtdPct),vsYTD:ue(o?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"NET REVENUE",icon:"revenue",iconBg:ce.revenue,active:"revenue"===e,onIconClick:()=>t(e=>"revenue"===e?null:"revenue"),value:w(p,c,he),vsLastMonth:ue(c?.mtdPct),vsYTD:ue(c?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"BIR SHARE",icon:"share",iconBg:ce.share,active:"share"===e,onIconClick:()=>t(e=>"share"===e?null:"share"),value:w(x,u,fe),vsLastMonth:ue(u?.mtdPct),vsYTD:ue(u?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"PODS",icon:"pods",iconBg:ce.pods,active:"pods"===e,onIconClick:()=>t(e=>"pods"===e?null:"pods"),value:w(f,g,xe),vsLastMonth:ue(g?.mtdPct),vsYTD:ue(g?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"TAPS",icon:"taps",iconBg:ce.taps,active:"taps"===e,onIconClick:()=>t(e=>"taps"===e?null:"taps"),value:w(m,y,xe),vsLastMonth:ue(y?.mtdPct),vsYTD:ue(y?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"DISPLAYS",icon:"displays",iconBg:ce.displays,active:"displays"===e,onIconClick:()=>t(e=>"displays"===e?null:"displays"),value:w(b,v,xe),vsLastMonth:ue(v?.mtdPct),vsYTD:ue(v?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"AVD",icon:"avd",iconBg:ce.avd,active:"avd"===e,onIconClick:()=>t(e=>"avd"===e?null:"avd"),value:w(S,j,ye),vsLastMonth:ue(j?.mtdPct),vsYTD:ue(j?.ytdPct),includeAO:n}),(0,l.jsx)(q,{label:"AD SHARE",icon:"adshare",iconBg:ce.adshare,active:"adshare"===e,onIconClick:()=>t(e=>"adshare"===e?null:"adshare"),value:w(A,k,fe),vsLastMonth:ue(k?.mtdPct),vsYTD:ue(k?.ytdPct),includeAO:n})]}),e&&(0,l.jsx)("div",{style:{backgroundColor:ce[e],borderRadius:"16px",padding:"1.5rem",height:280,marginBottom:"1.15rem"},children:F?(0,l.jsx)(le,{title:`Monthly ${e.toUpperCase()} Trend`,data:F,dataKey:"value"}):(0,l.jsx)("div",{style:{height:"100%",display:"grid",placeItems:"center",opacity:.5},children:"No trend data available"})}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(500px, 1fr))",gap:"1.5rem",marginBottom:"1.15rem"},children:[(0,l.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 10px 24px rgba(10,22,51,0.10)",padding:"1.25rem",minHeight:520,display:"flex",flexDirection:"column"},children:[(0,l.jsx)(h,{onSelectState:()=>{}}),(0,l.jsx)("div",{className:"subtle-scroll",style:{flex:1,overflowY:"auto",minWidth:0,borderTop:"1px solid #e2e8f0",marginTop:12,paddingTop:12},children:(0,l.jsx)($,{selectedMetric:e})})]}),(0,l.jsx)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 10px 24px rgba(10,22,51,0.10)",padding:"1.25rem",minHeight:520,display:"flex",flexDirection:"column"},children:(0,l.jsx)("div",{className:"subtle-scroll",style:{flex:1,overflowY:"auto",minWidth:0},children:(0,l.jsx)(I,{selectedMetric:e})})})]})]})})]})}function ve(){return(0,l.jsx)(r.A,{children:(0,l.jsx)(me,{})})}function be(){return(0,l.jsx)(ve,{})}}}]);