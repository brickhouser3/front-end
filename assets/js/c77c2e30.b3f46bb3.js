"use strict";(globalThis.webpackChunkfront_end=globalThis.webpackChunkfront_end||[]).push([[773],{6929(e,r,n){n.r(r),n.d(r,{default:()=>d});var s=n(6540),i=n(7135),t=n(4586),o=n(4848);function a({apiUrl:e,origin:r,running:n,results:s,onRunTests:i}){return(0,o.jsxs)("div",{style:{padding:22,maxWidth:1100},children:[(0,o.jsx)("h1",{style:{margin:0,fontSize:22,fontWeight:800},children:"Support"}),(0,o.jsx)("p",{style:{marginTop:10,color:"rgba(15,23,42,0.70)"},children:"API diagnostics \u2014 Frontend \u2192 Vercel \u2192 Databricks"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:16,marginBottom:10,flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:i,disabled:n,style:{padding:"10px 14px",borderRadius:10,fontWeight:700,border:"1px solid rgba(15,23,42,0.15)",background:n?"#e5e7eb":"#ffffff",cursor:n?"not-allowed":"pointer"},children:n?"Running\u2026":"Run API Tests"}),(0,o.jsxs)("div",{style:{fontSize:12,color:"rgba(15,23,42,0.6)"},children:["Target: ",(0,o.jsx)("code",{children:e})]}),(0,o.jsxs)("div",{style:{fontSize:12,color:"rgba(15,23,42,0.6)"},children:["Origin: ",(0,o.jsx)("code",{children:r})]})]}),0===s.length?(0,o.jsx)("div",{style:{fontSize:13,color:"rgba(15,23,42,0.6)"},children:"No test results yet."}):(0,o.jsx)("div",{style:{display:"grid",gap:14,marginTop:10},children:s.map((e,r)=>(0,o.jsxs)("div",{style:{padding:14,borderRadius:14,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.75)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10},children:[(0,o.jsxs)("div",{style:{fontWeight:700},children:[e.ok?"\u2705":"\u274c"," ",e.name]}),(0,o.jsxs)("div",{style:{fontFamily:"monospace",fontSize:12,opacity:.7},children:[e.status," \u2022 ",e.ms,"ms"]})]}),(0,o.jsxs)("div",{style:{marginTop:8,fontSize:12,opacity:.85},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"CORS allow-origin:"})," ",(0,o.jsx)("code",{children:e.responseHeaders["access-control-allow-origin"]??"(not exposed / missing)"})]}),(0,o.jsxs)("div",{style:{marginTop:6},children:[(0,o.jsx)("strong",{children:"Signature:"})," ",(0,o.jsx)("code",{children:e.responseHeaders["x-mc-api"]??"(not exposed / missing)"})]})]}),(0,o.jsxs)("details",{style:{marginTop:10},children:[(0,o.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"Parsed JSON"}),(0,o.jsx)("pre",{style:{marginTop:8,fontSize:12},children:JSON.stringify(e.json,null,2)})]}),(0,o.jsxs)("details",{style:{marginTop:10},children:[(0,o.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"Raw response"}),(0,o.jsx)("pre",{style:{marginTop:8,fontSize:12},children:e.raw})]}),!e.ok&&e.error?(0,o.jsxs)("div",{style:{marginTop:10,color:"rgba(220,38,38,0.9)",fontSize:12},children:[(0,o.jsx)("strong",{children:"Error:"})," ",e.error]}):null]},r))})]})}async function l(e,r,n){const s=performance.now();try{const i=await fetch(r,n),t=Math.round(performance.now()-s),o=await i.text(),a=function(e){try{return JSON.parse(e)}catch{return null}}(o),l=Object.fromEntries(i.headers.entries());return{name:e,ok:i.ok,status:i.status,ms:t,url:r,responseHeaders:l,raw:o,json:a,error:i.ok?void 0:o}}catch(i){return{name:e,ok:!1,status:0,ms:Math.round(performance.now()-s),url:r,responseHeaders:{},raw:"",json:null,error:i?.message??"Failed to fetch"}}}function d(){const{siteConfig:e}=(0,t.A)(),r=e.customFields||{},n=r.apiProdQueryUrl,d=r.apiBaseUrl,c=(0,s.useMemo)(()=>{return n&&n.trim()?n.trim().replace(/\/+$/,""):d&&d.trim()?(e=d.trim(),r="api/query",`${e.replace(/\/+$/,"")}/${r.replace(/^\/+/,"")}`):"https://ci-capabilities-api.vercel.app/api/query";var e,r},[n,d]),p="undefined"!=typeof window?window.location.origin:"(ssg)",[u,g]=(0,s.useState)(!1),[h,m]=(0,s.useState)([]);return(0,o.jsx)(i.A,{children:(0,o.jsx)(a,{apiUrl:c,origin:p,running:u,results:h,onRunTests:async function(){g(!0),m([]);const e=[];e.push(await l("GET (health)",c,{method:"GET",headers:{Accept:"application/json"},cache:"no-store"})),m([...e]),e.push(await l("POST ping (transport only)",c,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({ping:!0,requestedAt:(new Date).toISOString(),origin:p})})),m([...e]),e.push(await l("POST kpi_request.v1 (volume)",c,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contract_version:"kpi_request.v1",kpi:"volume"})})),m([...e]),g(!1)}})})}}}]);