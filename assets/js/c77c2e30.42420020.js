"use strict";(globalThis.webpackChunkfront_end=globalThis.webpackChunkfront_end||[]).push([[773],{6929(e,s,r){r.r(s),r.d(s,{default:()=>d});var n=r(6540),t=r(7135),i=r(4586),o=r(4848);function a({apiUrl:e,running:s,results:r,onRunTests:n}){return(0,o.jsxs)("div",{style:{padding:22,maxWidth:1100},children:[(0,o.jsx)("h1",{style:{margin:0,fontSize:22,fontWeight:800},children:"Support"}),(0,o.jsx)("p",{style:{marginTop:10,color:"rgba(15,23,42,0.70)"},children:"API diagnostics \u2014 Frontend \u2192 Vercel \u2192 Databricks"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:16,marginBottom:20},children:[(0,o.jsx)("button",{onClick:n,disabled:s,style:{padding:"10px 14px",borderRadius:10,fontWeight:700,border:"1px solid rgba(15,23,42,0.15)",background:s?"#e5e7eb":"#ffffff",cursor:s?"not-allowed":"pointer"},children:s?"Running\u2026":"Run API Tests"}),(0,o.jsxs)("div",{style:{fontSize:12,color:"rgba(15,23,42,0.6)"},children:["Target: ",(0,o.jsx)("code",{children:e})]})]}),0===r.length?(0,o.jsx)("div",{style:{fontSize:13,color:"rgba(15,23,42,0.6)"},children:"No test results yet."}):(0,o.jsx)("div",{style:{display:"grid",gap:14},children:r.map((e,s)=>(0,o.jsxs)("div",{style:{padding:14,borderRadius:14,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.75)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{style:{fontWeight:700},children:[e.ok?"\u2705":"\u274c"," ",e.name]}),(0,o.jsxs)("div",{style:{fontFamily:"monospace",fontSize:12,opacity:.7},children:[e.status," \u2022 ",e.ms,"ms"]})]}),(0,o.jsxs)("div",{style:{marginTop:8,fontSize:12,opacity:.8},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"CORS:"})," ",(0,o.jsx)("code",{children:e.responseHeaders["access-control-allow-origin"]??"(missing)"})]}),(0,o.jsxs)("div",{style:{marginTop:6},children:[(0,o.jsx)("strong",{children:"Signature:"})," ",(0,o.jsx)("code",{children:e.responseHeaders["x-mc-api"]??"(missing)"})]})]}),(0,o.jsxs)("details",{style:{marginTop:10},children:[(0,o.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"Parsed JSON"}),(0,o.jsx)("pre",{style:{marginTop:8,fontSize:12},children:JSON.stringify(e.json,null,2)})]}),(0,o.jsxs)("details",{style:{marginTop:10},children:[(0,o.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"Raw response"}),(0,o.jsx)("pre",{style:{marginTop:8,fontSize:12},children:e.raw})]}),!e.ok&&e.error?(0,o.jsxs)("div",{style:{marginTop:10,color:"rgba(220,38,38,0.9)",fontSize:12},children:[(0,o.jsx)("strong",{children:"Error:"})," ",e.error]}):null]},s))})]})}async function l(e,s,r){const n=performance.now();try{const t=await fetch(s,r),i=Math.round(performance.now()-n),o=await t.text(),a=function(e){try{return JSON.parse(e)}catch{return null}}(o),l=Object.fromEntries(t.headers.entries());return{name:e,ok:t.ok,status:t.status,ms:i,url:s,responseHeaders:l,raw:o,json:a,error:t.ok?void 0:o}}catch(t){return{name:e,ok:!1,status:0,ms:Math.round(performance.now()-n),url:s,responseHeaders:{},raw:"",json:null,error:t?.message??"Failed to fetch"}}}function d(){const{siteConfig:e}=(0,i.A)(),s=e.customFields?.apiQueryUrl,r=(0,n.useMemo)(()=>s?s.trim().replace(/\/+$/,""):"",[s]),[d,c]=(0,n.useState)(!1),[p,u]=(0,n.useState)([]);return(0,o.jsx)(t.A,{children:(0,o.jsx)(a,{apiUrl:r||"(missing apiQueryUrl)",running:d,results:p,onRunTests:async function(){if(!r)return void u([{name:"Config error",ok:!1,status:0,ms:0,url:"(missing)",responseHeaders:{},raw:"",json:null,error:"customFields.apiQueryUrl is not configured (expected full URL ending with /api/query)"}]);c(!0),u([]);const e=[];e.push(await l("GET (health)",r,{method:"GET",headers:{Accept:"application/json"}})),u([...e]),e.push(await l("POST ping (transport only)",r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({ping:!0,requestedAt:(new Date).toISOString()})})),u([...e]),e.push(await l("POST kpi_request.v1 (volume)",r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contract_version:"kpi_request.v1",kpi:"volume"})})),u([...e]),c(!1)}})})}}}]);